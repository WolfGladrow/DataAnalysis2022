myMADN = function(x){
  # myMADN.R
  # created by: Dieter.Wolf-Gladrow@awi.de 
  #    2/2017 version 1.0
  # This software is provided 'as is' without warranty of
  # any kind. But it's mine, so you can't sell it.
  # source('myMADN.R')
  MADN=median(abs(x-median(x)))/0.6745; n = length(x);
  if(n < 5) print(n,'Sample is too small for correction');
  if( (n > 4) && (n < 101)) {
    # scale factors for n = 5 to 100 (based on Monte Carlo simulation with
    #                                 M = 1e5 random samples from normal PDF)
    sc = c(0.5564, 0.5666, 0.5938, 0.5979, 0.6119, 0.6158, 0.6259, 0.6250, 0.6324, 
           0.6332, 0.6382, 0.6396, 0.6423, 0.6430, 0.6465, 0.6469, 0.6487, 0.6493, 
           0.6517, 0.6511, 0.6530, 0.6540, 0.6545, 0.6550, 0.6570, 0.6566, 0.6571, 
           0.6582, 0.6581, 0.6590, 0.6597, 0.6597, 0.6595, 0.6606, 0.6614, 0.6614, 
           0.6616, 0.6613, 0.6619, 0.6624, 0.6629, 0.6625, 0.6638, 0.6636, 0.6632,
           0.6638, 0.6644, 0.6640, 0.6645, 0.6645, 0.6648, 0.6648, 0.6658, 0.6655, 
           0.6653, 0.6654, 0.6659, 0.6659, 0.6661, 0.6665, 0.6669, 0.6665, 0.6667,
           0.6668, 0.6670, 0.6667, 0.6674, 0.6671, 0.6674, 0.6670, 0.6674, 0.6677, 
           0.6675, 0.6678, 0.6681, 0.6681, 0.6683, 0.6683, 0.6679, 0.6681, 0.6687, 
           0.6681, 0.6686, 0.6685, 0.6687, 0.6684, 0.6689, 0.6689, 0.6690, 0.6691,
           0.6691, 0.6693, 0.6692, 0.6693, 0.6691, 0.6693);
    MADN = median(abs(x-median(x)))/sc[n-4]}
  return(MADN)}